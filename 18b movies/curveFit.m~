% lt = lifetime;  vl = velocity; gof = goodness of fit
% Frequency distributiion of Lifetime -> exponential curve fit -> calculate
% important parameters including K and tau. 

%% Resave data separately as Neg2 and 18B2. 

clc; clear;
load TracksInfo_plot.mat; 

 
% Pool all the lifetimes data together. 
Neg2.lt_total = [];
Kif18B.lt_total = [];

for i = 1:length(TracksInfo)
    matches = strfind({TracksInfo(i).name},'Neg'); 
    tf = any(vertcat(matches{:}));
    if tf >0
    Neg2.lt_total = [ Neg2.lt_total; TracksInfo(i).life_times ];
    else
    Kif18B.lt_total = [ Kif18B.lt_total; TracksInfo(i).life_times ];
    end
end 
clear ( 'i', 'tf', 'matches' ); 

%% Frequency distribution and Exponential fit of life_times data 

% For Neg2
tbl_temp= tabulate( Neg2.lt_total );
tbl = tbl_temp( 4:2:end, : ); 
clear tbl_temp;

Neg2.lt_bin = tbl(:,1);
Neg2.lt_freq_dist = tbl(:,3); 

[Neg2.lt_fitresult, Neg2.lt_gof] = createExpFit( Neg2.lt_bin, Neg2.lt_freq_dist, 'Neg2' );
save ( 'Neg2_EB1_analysis.mat', 'Neg2' );

% For 18B
tbl_temp= tabulate( Kif18B.lt_total );
tbl = tbl_temp( 4:2:end, : ); 
clear tbl_temp;

Kif18B.lt_bin = tbl(:,1);
Kif18B.lt_freq_dist = tbl(:,3); 
[Kif18B.lt_fitresult, Kif18B.lt_gof] = createExpFit( Kif18B.lt_bin, Kif18B.lt_freq_dist, '18B2' );
save ( 'Kif18B_EB1_analysis.mat', 'Kif18B' );
close all; 

%% Pool all the velocity data together. 
Neg2.vl_total = []; 
Kif18B.vl_total = []; 

for i = 1:length(TracksInfo)
    matches = strfind({TracksInfo(i).name},'Neg'); 
    tf = any(vertcat(matches{:}));
    if tf >0
    Neg2.vl_total  = [ Neg2.vl_total;  TracksInfo(i).vel_means ];
    else
    Kif18B.vl_total  = [ Kif18B.vl_total;  TracksInfo(i).vel_means ];
    end
end 
clear ( 'i', 'tf', 'matches' ); 

%% Frequency distribution and Gaussian fit of life_times data 
edges = 0:2:30;
% For Neg2
[ counts, binValues ] = hist( Neg2.vl_total, edges );
% 'counts' is real number. We normalize it to percentage. 
normalizedCounts = 100 * counts' / sum(counts); 


[fitresult, gof] = createGaussianFit( binValues, normalizedCounts, 'Neg2' )


